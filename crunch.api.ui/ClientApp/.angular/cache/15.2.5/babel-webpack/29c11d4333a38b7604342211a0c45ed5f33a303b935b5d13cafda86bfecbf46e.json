{"ast":null,"code":"import { CrunchedSuccessfullyComponent } from '../shared/dialogs/crunched-successfully/crunched-successfully.component';\nimport { CrunchedUnSuccessfulComponent } from '../shared/dialogs/crunched-un-successful/crunched-un-successful.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../shared/services/crunch/crunch.service\";\nimport * as i2 from \"ngx-spinner\";\nimport * as i3 from \"ngx-bootstrap/modal\";\nimport * as i4 from \"@angular/forms\";\nexport class HomeComponent {\n  constructor(crunchService, spinner, modaleService) {\n    this.crunchService = crunchService;\n    this.spinner = spinner;\n    this.modaleService = modaleService;\n  }\n  ngOnInit() {}\n  onFileChange($event) {\n    var fileList = $event?.target.files;\n    if (fileList.length > 0) {\n      this.crunchFile = fileList[0];\n    }\n  }\n  appendFileContent(file) {\n    const uploadFormData = new FormData();\n    var ext = /^.+\\.([^.]+)$/.exec(file.name);\n    var fileExtension = null ? \"\" : ext[1];\n    if (fileExtension.toLowerCase() === 'txt') {\n      uploadFormData.append('documentFileName', file.name);\n      uploadFormData.append('documentFile', file);\n      uploadFormData.append('documentDescription', 'Pre-Cruch File');\n    }\n    return uploadFormData;\n  }\n  sendToCruncher(crunchService) {\n    this.spinner.show();\n    var crunchFileAndContents = this.appendFileContent(this.crunchFile);\n    var crunchSubscription = crunchService.CrunchWord(crunchFileAndContents).subscribe({\n      next: response => {\n        this.spinner.hide();\n        if (response.isSuccess) {\n          var modalConfig = {\n            class: 'modal-md',\n            backdrop: 'static',\n            initialState: {\n              crunchedString: response.data\n            }\n          };\n          this.modaleService.show(CrunchedSuccessfullyComponent, modalConfig);\n        } else {\n          var modalConfig = {\n            class: 'modal-md',\n            backdrop: 'static',\n            initialState: {\n              unsuccessfullMessage: response.message\n            }\n          };\n          this.modaleService.show(CrunchedUnSuccessfulComponent, modalConfig);\n        }\n      },\n      error: error => {\n        this.spinner.hide();\n      }\n    });\n    return crunchSubscription;\n  }\n}\nHomeComponent.ɵfac = function HomeComponent_Factory(t) {\n  return new (t || HomeComponent)(i0.ɵɵdirectiveInject(i1.CrunchService), i0.ɵɵdirectiveInject(i2.NgxSpinnerService), i0.ɵɵdirectiveInject(i3.BsModalService));\n};\nHomeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: HomeComponent,\n  selectors: [[\"app-home\"]],\n  decls: 9,\n  vars: 1,\n  consts: [[\"type\", \"ball-scale-multiple\"], [1, \"form-wrapper\"], [1, \"row\"], [\"type\", \"file\", \"accept\", \"\", 3, \"change\"], [1, \"mt-3\"], [1, \"btn\", \"btn-primary\", 3, \"disabled\", \"click\"]],\n  template: function HomeComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"ngx-spinner\", 0);\n      i0.ɵɵelementStart(1, \"div\")(2, \"div\", 1)(3, \"form\")(4, \"div\", 2)(5, \"input\", 3);\n      i0.ɵɵlistener(\"change\", function HomeComponent_Template_input_change_5_listener($event) {\n        return ctx.onFileChange($event);\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(6, \"div\", 4)(7, \"button\", 5);\n      i0.ɵɵlistener(\"click\", function HomeComponent_Template_button_click_7_listener() {\n        return ctx.sendToCruncher(ctx.crunchService);\n      });\n      i0.ɵɵtext(8, \"Crunch\");\n      i0.ɵɵelementEnd()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"disabled\", !ctx.crunchFile);\n    }\n  },\n  dependencies: [i4.ɵNgNoValidate, i4.NgControlStatusGroup, i4.NgForm, i2.NgxSpinnerComponent],\n  encapsulation: 2\n});","map":{"version":3,"mappings":"AAMA,SAASA,6BAA6B,QAAQ,yEAAyE;AACvH,SAASC,6BAA6B,QAAQ,2EAA2E;;;;;;AAOzH,OAAM,MAAOC,aAAa;EAIxBC,YACSC,aAA4B,EAC3BC,OAA0B,EAC1BC,aAA6B;IAF9B,kBAAa,GAAbF,aAAa;IACZ,YAAO,GAAPC,OAAO;IACP,kBAAa,GAAbC,aAAa;EACnB;EAEJC,QAAQ,IAGR;EAEAC,YAAY,CAACC,MAAW;IAEtB,IAAIC,QAAQ,GAAGD,MAAM,EAAEE,MAAM,CAACC,KAAK;IAEnC,IAAGF,QAAQ,CAACG,MAAM,GAAG,CAAC,EAAC;MAErB,IAAI,CAACC,UAAU,GAAGJ,QAAQ,CAAC,CAAC,CAAC;;EAIjC;EAEQK,iBAAiB,CAACC,IAAU;IAElC,MAAMC,cAAc,GAAG,IAAIC,QAAQ,EAAE;IAErC,IAAIC,GAAG,GAAQ,eAAe,CAACC,IAAI,CAACJ,IAAI,CAACK,IAAI,CAAC;IAC9C,IAAIC,aAAa,GAAW,IAAI,GAAG,EAAE,GAAGH,GAAG,CAAC,CAAC,CAAC;IAE9C,IAAGG,aAAa,CAACC,WAAW,EAAE,KAAK,KAAK,EAAC;MAEvCN,cAAc,CAACO,MAAM,CAAC,kBAAkB,EAAER,IAAI,CAACK,IAAI,CAAC;MACpDJ,cAAc,CAACO,MAAM,CAAC,cAAc,EAAER,IAAI,CAAC;MAC3CC,cAAc,CAACO,MAAM,CAAC,qBAAqB,EAAE,gBAAgB,CAAC;;IAIhE,OAAOP,cAAc;EAEvB;EAEOQ,cAAc,CAACrB,aAA4B;IAEhD,IAAI,CAACC,OAAO,CAACqB,IAAI,EAAE;IAEnB,IAAIC,qBAAqB,GAAG,IAAI,CAACZ,iBAAiB,CAAC,IAAI,CAACD,UAAU,CAAC;IAEnE,IAAIc,kBAAkB,GAAGxB,aAAa,CAACyB,UAAU,CAACF,qBAAqB,CAAC,CAACG,SAAS,CAAC;MAEjFC,IAAI,EAAGC,QAAqB,IAAI;QAE9B,IAAI,CAAC3B,OAAO,CAAC4B,IAAI,EAAE;QAEnB,IAAGD,QAAQ,CAACE,SAAS,EAAC;UAEpB,IAAIC,WAAW,GAAgB;YAC7BC,KAAK,EAAE,UAAU;YACjBC,QAAQ,EAAE,QAAQ;YAClBC,YAAY,EAAE;cAACC,cAAc,EAAEP,QAAQ,CAACQ;YAAI;WAC7C;UAED,IAAI,CAAClC,aAAa,CAACoB,IAAI,CAAC1B,6BAA6B,EAAEmC,WAAW,CAAC;SAEpE,MAAI;UAEH,IAAIA,WAAW,GAAgB;YAC7BC,KAAK,EAAE,UAAU;YACjBC,QAAQ,EAAE,QAAQ;YAClBC,YAAY,EAAE;cAACG,oBAAoB,EAAET,QAAQ,CAACU;YAAO;WACtD;UAED,IAAI,CAACpC,aAAa,CAACoB,IAAI,CAACzB,6BAA6B,EAAEkC,WAAW,CAAC;;MAIvE,CAAC;MACDQ,KAAK,EAAGA,KAAK,IAAI;QAEf,IAAI,CAACtC,OAAO,CAAC4B,IAAI,EAAE;MAErB;KAED,CAAC;IAEF,OAAOL,kBAAkB;EAE3B;;AA3FW1B,aAAa;mBAAbA,aAAa;AAAA;AAAbA,aAAa;QAAbA,aAAa;EAAA0C;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCd1BC,iCAAsD;MAEtDA,2BAAK;MAOgCA;QAAA,OAAUC,wBAAoB;MAAA,EAAC;MAA5DD,iBAA6D;MAG/DA,8BAAmB;MACTA;QAAA,OAASC,qCAA6B;MAAA,EAAC;MAAmDD,sBAAM;MAAAA,iBAAS;;;MAAjEA,eAAwB;MAAxBA,0CAAwB","names":["CrunchedSuccessfullyComponent","CrunchedUnSuccessfulComponent","HomeComponent","constructor","crunchService","spinner","modaleService","ngOnInit","onFileChange","$event","fileList","target","files","length","crunchFile","appendFileContent","file","uploadFormData","FormData","ext","exec","name","fileExtension","toLowerCase","append","sendToCruncher","show","crunchFileAndContents","crunchSubscription","CrunchWord","subscribe","next","response","hide","isSuccess","modalConfig","class","backdrop","initialState","crunchedString","data","unsuccessfullMessage","message","error","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"","sources":["C:\\Users\\bongi\\source\\repos\\Angular-Projects\\alexforbes.crunch.assess\\crunch.api.ui\\ClientApp\\src\\app\\home\\home.component.ts","C:\\Users\\bongi\\source\\repos\\Angular-Projects\\alexforbes.crunch.assess\\crunch.api.ui\\ClientApp\\src\\app\\home\\home.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { CrunchService } from '../shared/services/crunch/crunch.service';\r\nimport { ApiResponse } from '../shared/models/http-response.model';\r\nimport { NgxSpinnerService } from 'ngx-spinner';\r\nimport { BsModalService, ModalOptions } from 'ngx-bootstrap/modal'\r\nimport { CrunchedSuccessfullyComponent } from '../shared/dialogs/crunched-successfully/crunched-successfully.component';\r\nimport { CrunchedUnSuccessfulComponent } from '../shared/dialogs/crunched-un-successful/crunched-un-successful.component';\r\n\r\n\r\n@Component({\r\n  selector: 'app-home',\r\n  templateUrl: './home.component.html',\r\n})\r\nexport class HomeComponent implements OnInit {\r\n\r\n  public crunchFile: File;\r\n\r\n  public constructor(\r\n    public crunchService: CrunchService,\r\n    private spinner: NgxSpinnerService,\r\n    private modaleService: BsModalService\r\n    ){}\r\n\r\n  ngOnInit(): void {\r\n\r\n\r\n  }\r\n\r\n  onFileChange($event: any){\r\n\r\n    var fileList = $event?.target.files;\r\n\r\n    if(fileList.length > 0){\r\n\r\n      this.crunchFile = fileList[0];\r\n\r\n    }\r\n\r\n  }\r\n\r\n  private appendFileContent(file: File): FormData{\r\n    \r\n    const uploadFormData = new FormData();\r\n\r\n    var ext: any = /^.+\\.([^.]+)$/.exec(file.name);\r\n    var fileExtension: string = null ? \"\" : ext[1];\r\n\r\n    if(fileExtension.toLowerCase() === 'txt'){\r\n\r\n      uploadFormData.append('documentFileName', file.name);\r\n      uploadFormData.append('documentFile', file);\r\n      uploadFormData.append('documentDescription', 'Pre-Cruch File');\r\n\r\n    }\r\n\r\n    return uploadFormData;\r\n\r\n  }\r\n\r\n  public sendToCruncher(crunchService: CrunchService): Subscription{\r\n\r\n    this.spinner.show();\r\n\r\n    var crunchFileAndContents = this.appendFileContent(this.crunchFile);\r\n\r\n    var crunchSubscription = crunchService.CrunchWord(crunchFileAndContents).subscribe({\r\n\r\n      next: (response: ApiResponse) => {\r\n\r\n        this.spinner.hide();\r\n\r\n        if(response.isSuccess){\r\n\r\n          var modalConfig: ModalOptions ={\r\n            class: 'modal-md',\r\n            backdrop: 'static',\r\n            initialState: {crunchedString: response.data}\r\n          };\r\n\r\n          this.modaleService.show(CrunchedSuccessfullyComponent, modalConfig);\r\n\r\n        }else{\r\n\r\n          var modalConfig: ModalOptions ={\r\n            class: 'modal-md',\r\n            backdrop: 'static',\r\n            initialState: {unsuccessfullMessage: response.message}\r\n          };\r\n\r\n          this.modaleService.show(CrunchedUnSuccessfulComponent, modalConfig);\r\n\r\n        }\r\n\r\n      },\r\n      error: (error) => {\r\n\r\n        this.spinner.hide();\r\n\r\n      }\r\n\r\n    });\r\n\r\n    return crunchSubscription;\r\n\r\n  }\r\n\r\n\r\n}\r\n","<ngx-spinner type=\"ball-scale-multiple\"></ngx-spinner>\r\n\r\n<div>\r\n\r\n  <div class=\"form-wrapper\">\r\n\r\n    <form>\r\n\r\n      <div class=\"row\">\r\n        <input type=\"file\" accept=\"\" (change)=\"onFileChange($event)\">\r\n      </div>\r\n  \r\n      <div class=\"mt-3\" >\r\n        <button (click)=\"sendToCruncher(crunchService)\" [disabled]=\"!crunchFile\" class=\"btn btn-primary\" >Crunch</button>\r\n      </div>\r\n    \r\n    </form>\r\n\r\n  </div>\r\n\r\n \r\n\r\n</div>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}